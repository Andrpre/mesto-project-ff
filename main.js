(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){"Escape"===e.key&&r(document.querySelector(".popup_is-opened"))}function n(e){var t=document.querySelector(".popup_is-opened");t===e.target&&r(t)}function o(e){e.classList.add("popup_is-opened"),e.classList.remove("popup_is-animated"),document.addEventListener("keydown",t),e.addEventListener("click",n)}function r(e){e.classList.remove("popup_is-opened"),e.classList.add("popup_is-animated"),document.removeEventListener("keydown",t),e.removeEventListener("click",n)}e.d({},{a:()=>z,A:()=>B});var c="dc67c79f-1c3d-4338-96c1-1207986f4fe9",i="wff-cohort-8",u=function(){return fetch("https://nomoreparties.co/v1/".concat(i,"/users/me"),{headers:{authorization:c}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))};function a(e,t,n,u){var a=n.cloneNode(!0),s=a.querySelector(".card__image"),l=a.querySelector(".card__delete-button"),p=a.querySelector(".card__like-button"),d=a.querySelector(".card__like-counter");return s.src=t.link,s.alt=t.name,a.querySelector(".card__title").textContent=t.name,d.textContent=t.likes.length,function(e,t,n){e.some((function(e){return e._id===t}))?n.classList.add("card__like-button_is-active"):n.classList.remove("card__like-button_is-active")}(t.likes,e,p),function(e,t,n,u){t===n.owner._id?u.addEventListener("click",(function(){o(B),z.addEventListener("submit",(function(t){t.preventDefault(),function(e,t){(function(e){return fetch("https://nomoreparties.co/v1/".concat(i,"/cards/").concat(e),{method:"DELETE",headers:{authorization:c}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))})(t).then((function(){e.remove(),r(B)})).catch((function(e){console.error(e)}))}(e,n._id)}))})):u.remove()}(a,e,t,l),s.addEventListener("click",(function(){u(t.name,t.link)})),p.addEventListener("click",(function(){!function(e,t,n){e.classList.contains("card__like-button_is-active")?function(e){return fetch("https://nomoreparties.co/v1/".concat(i,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:c}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(t).then((function(t){e.classList.remove("card__like-button_is-active"),n.textContent=t.likes.length})).catch((function(e){console.error(e)})):function(e){return fetch("https://nomoreparties.co/v1/".concat(i,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:c}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(t).then((function(t){e.classList.add("card__like-button_is-active"),n.textContent=t.likes.length})).catch((function(e){console.error(e)}))}(p,t._id,d)})),a}function s(e,t){Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(n){n.classList.remove(t.inputErrorClass),e.querySelector(".".concat(n.id,"-error")).textContent=""}));var n=e.querySelector(t.submitButtonSelector);n.classList.add(t.inactiveButtonClass),n.setAttribute("disabled","disabled")}var l=function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n),r.textContent=o},p=function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),o.textContent=""};function d(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n),t.removeAttribute("disabled")):(t.classList.add(n),t.setAttribute("disabled","disabled"))}var _,f={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error"},m=document.querySelector(".places__list"),v=document.querySelector("#card-template").content.querySelector(".places__item"),y=document.querySelector(".profile__image"),h=document.querySelector(".popup_type_edit_avatar"),S=h.querySelector(".popup__close"),q=document.querySelector(".profile__edit-button"),k=document.querySelector(".popup_type_edit"),b=k.querySelector(".popup__close"),L=document.querySelector(".profile__title"),E=document.querySelector(".profile__description"),C=document.querySelector(".profile__add-button"),g=document.querySelector(".popup_type_new-card"),j=g.querySelector(".popup__close"),P=g.querySelector(".popup__form"),x=P.querySelector(".popup__input_type_card-name"),A=P.querySelector(".popup__input_type_url"),B=document.querySelector(".popup_type_delete-card"),T=B.querySelector(".popup__close"),z=B.querySelector(".popup__form"),O=h.querySelector(".popup__form"),w=O.querySelector(".popup__input_type_url_avatar"),D=k.querySelector(".popup__form"),N=D.querySelector(".popup__input_type_name"),J=D.querySelector(".popup__input_type_description"),M=document.querySelector(".popup_type_image"),H=M.querySelector(".popup__image"),I=M.querySelector(".popup__caption"),V=M.querySelector(".popup__close");function U(e,t){e.textContent=t?"Сохранение...":"Сохранить"}function F(e,t){H.src=t,H.alt=e,I.textContent=e,o(M)}y.addEventListener("click",(function(){o(h),O.reset()})),q.addEventListener("click",(function(){N.value=L.textContent,J.value=E.textContent,s(D,f),o(k)})),C.addEventListener("click",(function(){o(g),P.reset()})),S.addEventListener("click",(function(){return r(h)})),b.addEventListener("click",(function(){return r(k)})),j.addEventListener("click",(function(){return r(g)})),T.addEventListener("click",(function(){return r(B)})),V.addEventListener("click",(function(){return r(M)})),O.addEventListener("submit",(function(e){return function(e){e.preventDefault();var t,n=w.value,o=e.target.querySelector(f.submitButtonSelector);U(o,!0),(t=n,fetch("https://nomoreparties.co/v1/".concat(i,"/users/me/avatar"),{method:"PATCH",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){y.style.backgroundImage="url('".concat(e.avatar,"')"),r(h),U(o,!1)})).catch((function(e){console.error(e)}))}(e)})),D.addEventListener("submit",(function(e){return function(e){e.preventDefault();var t,n,o=e.target.elements.name.value,u=e.target.elements.description.value,a=e.target.querySelector(f.submitButtonSelector);U(a,!0),(t=o,n=u,fetch("https://nomoreparties.co/v1/".concat(i,"/users/me"),{method:"PATCH",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){L.textContent=e.name,E.textContent=e.about,r(k),U(a,!1)})).catch((function(e){console.error(e)}))}(e)})),P.addEventListener("submit",(function(e){!function(e){e.preventDefault();var t,n,o=e.target.querySelector(f.submitButtonSelector);U(o,!0),Promise.all([u(),(t=x.value,n=A.value,fetch("https://nomoreparties.co/v1/".concat(i,"/cards"),{method:"POST",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})))]).then((function(t){m.prepend(a(t[0]._id,t[1],v,F)),r(g),U(o,!1),e.target.reset()})).catch((function(e){console.error(e)}))}(e),s(P,f)})),Promise.all([u(),fetch("https://nomoreparties.co/v1/".concat(i,"/cards"),{headers:{authorization:c}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){var t,n;L.textContent=e[0].name,E.textContent=e[0].about,y.style.backgroundImage="url('".concat(e[0].avatar,"')"),t=m,n=e[0]._id,e[1].forEach((function(e){t.append(a(n,e,v,F))}))})).catch((function(e){console.error(e)})),_=f,Array.from(document.querySelectorAll(_.formSelector)).forEach((function(e){!function(e,t,n,o,r){var c=Array.from(e.querySelectorAll(t)),i=e.querySelector(n);d(c,i,r),c.forEach((function(t){t.addEventListener("input",(function(){(function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?p(e,t,n):l(e,t,n,t.validationMessage)})(e,t,o),d(c,i,r)}))}))}(e,_.inputSelector,_.submitButtonSelector,_.inputErrorClass,_.inactiveButtonClass)}))})();
//# sourceMappingURL=main.js.map